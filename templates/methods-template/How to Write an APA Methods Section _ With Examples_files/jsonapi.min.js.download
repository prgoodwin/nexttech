!function(t,r){function n(t){var r,n,a={};return p(t.included,function(t){var r=t.type+"-"+t.id;a[r]=t}),i(t.data)?r=f(t.data,function(t){return e(t,a),o(t)}):c(t.data)&&(e(t.data,a),r=o(t.data)),n={data:r,jsonapi:t.jsonapi||{}},t.meta&&(n.meta=t.meta),t.errors&&(n.errors=t.errors),t.links&&(n.links=t.links),n}function e(t,r,n){t.relationships&&(n=n?n.concat([t]):[t]),p(t.relationships,function(e,o){e&&c(e.meta)&&(t.meta=t.meta||{},t.meta[o]=e.meta),e.data&&(c(t.attributes)||(t.attributes={}),i(e.data)?t.attributes[o]=f(e.data,function(t){return a(t,r,n)}):t.attributes[o]=a(e.data,r,n))})}function a(t,r,n){var a,i;if(a=l(n,{id:t.id,type:t.type}))return t;var u=t.type+"-"+t.id;if(i=r[u],!i)return t;e(i,r,n);var s={};return t&&c(t.meta)&&(s=j({},i.meta,t.meta)),o(i,s)}function o(t,r){var n=j({},t.meta,r);return j({},{links:t.links,meta:n},t.attributes,{id:t.id,type:t.type})}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function u(t){return"[object String]"===Object.prototype.toString.call(t)}function c(t){return"[object Object]"===Object.prototype.toString.call(t)}function s(t){return t===r}function p(t,r){var n;if(i(t))for(n=0;n<t.length;n+=1)r(t[n],n);else if(c(t))for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&r(t[n],n)}function f(t,r){var n=[];return p(t,function(t,e){n.push(r(t,e))}),n}function d(t){var r=!0;return p(t,function(t){t!==!0&&(r=!1)}),r}function l(t,r){var n;return p(t,function(t){var e=f(r,function(r,n){return t[n]===r});d(e)&&(n=t)}),n}function j(){var t=Object(null),r=Array.prototype.slice.call(arguments);return p(r,function(r){p(r,function(r,n){t[n]=r})}),t}var m=t.jsonapi||(t.jsonapi={});m.parse=function(r){var e,a;if(u(r))try{e=t.JSON.parse(r)}catch(o){if("SyntaxError"===o.name)return r;throw o}else{if(!c(r))return r;e=r}return s(e.data)&&s(e.errors)&&s(e.meta)?e:e.jsonapi&&e.jsonapi.parsed?e:(a=n(e),a.jsonapi.parsed=!0,a)},"object"==typeof exports?c(module)&&c(module.exports)&&(exports=module.exports=m):t.jsonapi=m}("undefined"==typeof window?this:window);